{% extends "base.html" %}
{% block content %}
<div class="auth-card">
    <div class="card-body text-center">
        <h2 class="card-title">Welcome to DigiKenya</h2>
        <p class="card-subtitle">Choose your preferred sign-in method</p>

        <!-- Capture redirect_uri if it exists in the template context (passed from Flask route) -->
        {% set redirect_uri = request.args.get('redirect_uri') if request and request.args else None %}

        <!-- Primary sign-in method: Email/Password -->
        <div class="d-grid gap-3 mb-4">
            <!-- ⭐ UPDATED: Pass redirect_uri to the traditional login page -->
            <a href="{{ url_for('auth.login', redirect_uri=redirect_uri) }}" class="btn btn-primary-custom">
                <i class="bi bi-envelope-fill me-2"></i>
                Sign in with Email or Username
            </a>
        </div>

        <!-- Divider separating traditional login from SSO -->
        <div class="divider">
            <span>or continue with a linked service</span>
        </div>

        <!-- Social login options (SSO) -->
        <div class="d-grid gap-3 mt-4">
            <!-- ⭐ UPDATED: Pass redirect_uri to the Google login initiator -->
            <a href="{{ url_for('auth.login_google', redirect_uri=redirect_uri) }}" class="btn-social">
                <i class="bi bi-google"></i>
                <span>Continue with Google</span>
            </a>
            <!-- ⭐ UPDATED: Pass redirect_uri to the GitHub login initiator -->
            <a href="{{ url_for('auth.login_github', redirect_uri=redirect_uri) }}" class="btn-social">
                <i class="bi bi-github"></i>
                <span>Continue with GitHub</span>
            </a>
            <!-- Placeholder for additional SSO options -->
            <a href="#" class="btn-social">
                <i class="bi bi-microsoft"></i>
                <span>Continue with Microsoft</span>
            </a>
        </div>

        <!-- Footer link for account registration -->
        <p class="footer-text mt-4">
            <!-- ⭐ UPDATED: Pass redirect_uri to the registration page -->
            Don't have an account yet? <a href="{{ url_for('auth.register', redirect_uri=redirect_uri) }}" class="text-link">Register now</a>
        </p>
    </div>
</div>
{% endblock %}